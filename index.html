<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æƒ…ç»ªåˆ†è§£å™¨ - ç»“æ„åŒ–æƒ…ç»ªç®¡ç†å·¥å…·</title>
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #6b8cbc;
            --accent-color: #ff6b6b;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --success-color: #51a351;
            --warning-color: #f89406;
            --info-color: #2dacd1;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .description {
            color: #666;
            font-size: 1.1rem;
        }
        
        .history-btn {
            position: absolute;
            top: 20px;
            right: 0;
            background: var(--info-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }
        
        .card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .card h2 {
            color: var(--primary-color);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .week-view {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin: 15px 0;
        }
        
        .day {
            border: 1px solid #eee;
            padding: 10px 5px;
            text-align: center;
            border-radius: 4px;
            min-height: 120px;
        }
        
        .day-label {
            font-size: 0.8rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .time-slot {
            font-size: 0.7rem;
            background: #f0f7ff;
            margin: 2px 0;
            padding: 2px 5px;
            border-radius: 2px;
            border-left: 2px solid var(--info-color);
        }
        
        .stuck-point-item {
            background: #f8f9fa;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 4px;
            border-left: 4px solid var(--warning-color);
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .stuck-point-item:hover {
            background: #f0f3f8;
            transform: translateY(-2px);
        }
        
        .stuck-point-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .stuck-point-title {
            font-weight: bold;
            color: var(--dark-color);
        }
        
        .stuck-point-type {
            font-size: 0.8rem;
            background: #e9ecef;
            padding: 2px 8px;
            border-radius: 12px;
        }
        
        .stuck-point-desc {
            font-size: 0.9rem;
            margin-bottom: 8px;
            color: #555;
        }
        
        .stuck-point-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: #666;
        }
        
        .stuck-point-status {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
        }
        
        .status-unsolved {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-solving {
            background: #cce7ff;
            color: #004085;
        }
        
        .status-solved {
            background: #d4edda;
            color: #155724;
        }
        
        .empty-state {
            text-align: center;
            padding: 30px;
            color: #6c757d;
        }
        
        .btn-start {
            display: block;
            width: 100%;
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: background 0.3s;
            text-align: center;
            margin: 20px 0;
        }
        
        .btn-start:hover {
            background: var(--secondary-color);
        }
        
        .progress-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            position: relative;
        }
        
        .progress-container::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            width: 100%;
            height: 4px;
            background-color: #e0e0e0;
            z-index: 1;
        }
        
        .progress-bar {
            position: absolute;
            top: 15px;
            left: 0;
            height: 4px;
            background-color: var(--primary-color);
            z-index: 2;
            transition: width 0.3s ease;
        }
        
        .step-indicator {
            position: relative;
            z-index: 3;
            text-align: center;
            width: 100%;
        }
        
        .step-circle {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: #e0e0e0;
            color: #999;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 5px;
            transition: all 0.3s ease;
        }
        
        .step-active .step-circle {
            background-color: var(--primary-color);
            color: white;
        }
        
        .step-complete .step-circle {
            background-color: var(--success-color);
            color: white;
        }
        
        .step-label {
            font-size: 0.8rem;
            color: #999;
        }
        
        .step-active .step-label {
            color: var(--primary-color);
            font-weight: bold;
        }
        
        .step-content {
            display: none;
            background: white;
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
        }
        
        .step-active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            transition: border 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .btn {
            display: inline-block;
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: var(--secondary-color);
        }
        
        .btn-container {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .btn-next {
            background: var(--success-color);
        }
        
        .btn-next:hover {
            background: #448d44;
        }
        
        .btn-prev {
            background: #6c757d;
        }
        
        .btn-prev:hover {
            background: #5a6268;
        }
        
        .card-point {
            background: #f8f9fa;
            border-left: 4px solid var(--primary-color);
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 0 4px 4px 0;
        }
        
        .status-selector {
            display: flex;
            margin: 15px 0;
        }
        
        .status-option {
            flex: 1;
            text-align: center;
            padding: 10px;
            margin: 0 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .status-option:hover {
            background: #f0f0f0;
        }
        
        .status-option.active {
            border-color: var(--primary-color);
            background: #eef5ff;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            border-radius: 8px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }
        
        .history-list {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .edit-form {
            display: grid;
            gap: 15px;
        }
        
        .form-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .btn-delete {
            background: var(--accent-color);
        }
        
        .btn-delete:hover {
            background: #e05555;
        }
        
        .impact-selector {
            display: flex;
            gap: 10px;
        }
        
        .impact-option {
            flex: 1;
            text-align: center;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .impact-option.active {
            border-color: var(--primary-color);
            background: #eef5ff;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- é¦–é¡µ/ä»ªè¡¨æ¿ -->
        <div id="dashboard">
            <header>
                <h1>æƒ…ç»ªåˆ†è§£å™¨</h1>
                <p class="description">å°†æƒ…ç»ªå†…è€—è½¬åŒ–ä¸ºæ¸…æ™°è¡ŒåŠ¨çš„ç»“æ„åŒ–å·¥å…·</p>
                <button class="history-btn" onclick="showHistory()">æŸ¥çœ‹å†å²å¡ç‚¹</button>
            </header>
            
            <div class="dashboard">
                <div class="card">
                    <h2>æœ¬å‘¨å¾…åŠå¡ç‚¹</h2>
                    <div class="week-view" id="weeklySchedule">
                        <!-- å‘¨è§†å›¾å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
                
                <div class="card">
                    <h2>æœªè§£å†³å¡ç‚¹</h2>
                    <div id="unsolvedStuckPoints">
                        <!-- æœªè§£å†³å¡ç‚¹åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
            </div>
            
            <button class="btn-start" onclick="startEmotionDecomposition()">å¼€å§‹æ–°çš„æƒ…ç»ªåˆ†è§£</button>
        </div>
        
        <!-- æƒ…ç»ªåˆ†è§£æµç¨‹ -->
        <div id="decompositionFlow" style="display: none;">
            <header>
                <h1>æƒ…ç»ªåˆ†è§£å™¨</h1>
                <p class="description">å°†æƒ…ç»ªå†…è€—è½¬åŒ–ä¸ºæ¸…æ™°è¡ŒåŠ¨çš„ç»“æ„åŒ–å·¥å…·</p>
            </header>
            
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
                <div class="step-indicator step-active" data-step="1">
                    <div class="step-circle">1</div>
                    <div class="step-label">æƒ…ç»ªè®°å½•</div>
                </div>
                <div class="step-indicator" data-step="2">
                    <div class="step-circle">2</div>
                    <div class="step-label">å¡ç‚¹åˆ†æ</div>
                </div>
                <div class="step-indicator" data-step="3">
                    <div class="step-circle">3</div>
                    <div class="step-label">çªç ´æ–¹æ³•</div>
                </div>
                <div class="step-indicator" data-step="4">
                    <div class="step-circle">4</div>
                    <div class="step-label">æ—¶é—´åè°ƒ</div>
                </div>
                <div class="step-indicator" data-step="5">
                    <div class="step-circle">5</div>
                    <div class="step-label">æ‚å¿µæ”¶å®¹</div>
                </div>
                <div class="step-indicator" data-step="6">
                    <div class="step-circle">6</div>
                    <div class="step-label">æ€»ç»“è®¡åˆ’</div>
                </div>
            </div>
            
            <!-- æ­¥éª¤1ï¼šæƒ…ç»ªè®°å½• -->
            <div class="step-content step-active" id="step1">
                <h2>è®°å½•å½“å‰æƒ…ç»ª</h2>
                <div class="form-group">
                    <label for="emotionSelect">é€‰æ‹©ä¸»è¦æƒ…ç»ªæ ‡ç­¾</label>
                    <select id="emotionSelect">
                        <option value="">-- è¯·é€‰æ‹© --</option>
                        <option value="anxiety">ç„¦è™‘/å†…è€—</option>
                        <option value="frustration">çƒ¦èº/æ˜“æ€’</option>
                        <option value="procrastination">æ‹–å»¶/æ— åŠ›</option>
                        <option value="overexcited">è¿‡åº¦å…´å¥‹</option>
                        <option value="confusion">è¿·èŒ«/å›°æƒ‘</option>
                        <option value="other">å…¶ä»–ï¼ˆè‡ªå®šä¹‰ï¼‰</option>
                    </select>
                </div>
                
                <div class="form-group" id="customEmotion" style="display: none;">
                    <label for="customEmotionInput">è‡ªå®šä¹‰æƒ…ç»ªæè¿°</label>
                    <input type="text" id="customEmotionInput" placeholder="è¯·æè¿°æ‚¨çš„æƒ…ç»ªçŠ¶æ€">
                </div>
                
                <div class="form-group">
                    <label for="emotionContext">æƒ…ç»ªèƒŒæ™¯ï¼ˆå¯é€‰ï¼‰</label>
                    <textarea id="emotionContext" placeholder="æ˜¯ä»€ä¹ˆå¼•å‘äº†è¿™ç§æƒ…ç»ªï¼Ÿå‘ç”Ÿåœ¨ä»€ä¹ˆæƒ…å¢ƒä¸‹ï¼Ÿ"></textarea>
                </div>
                
                <div class="btn-container">
                    <button class="btn" onclick="goToDashboard()">è¿”å›é¦–é¡µ</button>
                    <button class="btn btn-next" onclick="navigateStep(2)">ä¸‹ä¸€æ­¥ï¼šå¡ç‚¹åˆ†æ</button>
                </div>
            </div>
            
            <!-- æ­¥éª¤2ï¼šå¡ç‚¹åˆ†æ -->
            <div class="step-content" id="step2">
                <h2>åˆ†æè¡ŒåŠ¨å¡ç‚¹</h2>
                <div class="form-group">
                    <label for="stuckPointType">å¡ç‚¹ç±»å‹</label>
                    <select id="stuckPointType">
                        <option value="">-- è¯·é€‰æ‹© --</option>
                        <option value="decision">å†³ç­–å›°å¢ƒï¼ˆéš¾ä»¥é€‰æ‹©ï¼‰</option>
                        <option value="action">è¡ŒåŠ¨å—é˜»ï¼ˆæ‹–å»¶/æ— åŠ›ï¼‰</option>
                        <option value="resources">èµ„æºå†²çªï¼ˆæ—¶é—´/ç²¾åŠ›ä¸è¶³ï¼‰</option>
                        <option value="meaning">æ„ä¹‰æ¨¡ç³Šï¼ˆç¼ºä¹åŠ¨åŠ›ï¼‰</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="stuckPointTitle">å¡ç‚¹æ ‡é¢˜</label>
                    <input type="text" id="stuckPointTitle" placeholder="ç®€è¦æè¿°è¿™ä¸ªå¡ç‚¹ï¼ˆå¦‚ï¼šæ˜¯å¦æ¢å·¥ä½œï¼‰">
                </div>
                
                <div class="form-group">
                    <label for="stuckPointDescription">å¡ç‚¹å…·ä½“æè¿°</label>
                    <textarea id="stuckPointDescription" placeholder="è¯·è¯¦ç»†æè¿°è¿™ä¸ªå¡ç‚¹ï¼šå…·ä½“æ˜¯ä»€ä¹ˆäº‹æƒ…ï¼Ÿä¸ºä»€ä¹ˆæ„Ÿåˆ°è¢«å¡ä½ï¼Ÿ"></textarea>
                </div>
                
                <div class="form-group">
                    <label>å½±å“è¯„ä¼°</label>
                    <div class="impact-selector">
                        <div class="impact-option" data-impact="high">é«˜å½±å“</div>
                        <div class="impact-option" data-impact="medium">ä¸­ç­‰å½±å“</div>
                        <div class="impact-option" data-impact="low">ä½å½±å“</div>
                    </div>
                </div>
                
                <div class="btn-container">
                    <button class="btn" onclick="goToDashboard()">è¿”å›é¦–é¡µ</button>
                    <button class="btn btn-prev" onclick="navigateStep(1)">ä¸Šä¸€æ­¥</button>
                    <button class="btn btn-next" onclick="navigateStep(3)">ä¸‹ä¸€æ­¥ï¼šçªç ´æ–¹æ³•</button>
                </div>
            </div>
            
            <!-- æ­¥éª¤3ï¼šçªç ´æ–¹æ³• -->
            <div class="step-content" id="step3">
                <h2>åˆ¶å®šçªç ´æ–¹æ³•</h2>
                <div class="card-point" id="currentStuckPointDisplay">
                    <!-- è¿™é‡Œä¼šåŠ¨æ€æ˜¾ç¤ºä¸Šä¸€æ­¥å¡«å†™çš„å¡ç‚¹å†…å®¹ -->
                </div>
                
                <div class="form-group">
                    <label for="breakthroughMethod">çªç ´æ–¹æ³•</label>
                    <textarea id="breakthroughMethod" placeholder="é’ˆå¯¹è¿™ä¸ªå¡ç‚¹ï¼Œæˆ‘å¯ä»¥å°è¯•çš„å…·ä½“çªç ´æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ"></textarea>
                </div>
                
                <div class="form-group">
                    <label>è¿›å±•çŠ¶æ€</label>
                    <div class="status-selector">
                        <div class="status-option active" data-status="planning">
                            <div>ğŸ’¡ æ„æ€ä¸­</div>
                        </div>
                        <div class="status-option" data-status="acting">
                            <div>ğŸš€ è¡ŒåŠ¨ä¸­</div>
                        </div>
                        <div class="status-option" data-status="wrapping">
                            <div>âœ… æ”¶å°¾ä¸­</div>
                        </div>
                    </div>
                </div>
                
                <div class="btn-container">
                    <button class="btn" onclick="goToDashboard()">è¿”å›é¦–é¡µ</button>
                    <button class="btn btn-prev" onclick="navigateStep(2)">ä¸Šä¸€æ­¥</button>
                    <button class="btn btn-next" onclick="navigateStep(4)">ä¸‹ä¸€æ­¥ï¼šæ—¶é—´åè°ƒ</button>
                </div>
            </div>
            
            <!-- æ­¥éª¤4ï¼šæ—¶é—´åè°ƒ -->
            <div class="step-content" id="step4">
                <h2>åè°ƒæ—¶é—´å®‰æ’</h2>
                <p>ä¸ºæ‚¨çš„çªç ´æ–¹æ³•å®‰æ’å…·ä½“æ‰§è¡Œæ—¶é—´ï¼Œé¿å…è®¡åˆ’å†²çªã€‚</p>
                
                <div class="week-view" id="timeCoordinationView">
                    <!-- å‘¨è§†å›¾å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
                
                <div class="form-group">
                    <label for="scheduledDay">è®¡åˆ’åœ¨å“ªå¤©å¤„ç†è¿™ä¸ªå¡ç‚¹ï¼Ÿ</label>
                    <select id="scheduledDay">
                        <option value="">-- é€‰æ‹©æ—¥æœŸ --</option>
                        <option value="å‘¨ä¸€">å‘¨ä¸€</option>
                        <option value="å‘¨äºŒ">å‘¨äºŒ</option>
                        <option value="å‘¨ä¸‰">å‘¨ä¸‰</option>
                        <option value="å‘¨å››">å‘¨å››</option>
                        <option value="å‘¨äº”">å‘¨äº”</option>
                        <option value="å‘¨å…­">å‘¨å…­</option>
                        <option value="å‘¨æ—¥">å‘¨æ—¥</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="timeCommitment">æ¯å‘¨æ—¶é—´æŠ•å…¥é¢„ä¼°</label>
                    <select id="timeCommitment">
                        <option value="1-3">1-3å°æ—¶</option>
                        <option value="3-5">3-5å°æ—¶</option>
                        <option value="5-10">5-10å°æ—¶</option>
                        <option value="10+">10å°æ—¶ä»¥ä¸Š</option>
                    </select>
                </div>
                
                <div class="btn-container">
                    <button class="btn" onclick="goToDashboard()">è¿”å›é¦–é¡µ</button>
                    <button class="btn btn-prev" onclick="navigateStep(3)">ä¸Šä¸€æ­¥</button>
                    <button class="btn btn-next" onclick="navigateStep(5)">ä¸‹ä¸€æ­¥ï¼šæ‚å¿µæ”¶å®¹</button>
                </div>
            </div>
            
            <!-- æ­¥éª¤5ï¼šæ‚å¿µæ”¶å®¹ -->
            <div class="step-content" id="step5">
                <h2>æ”¶å®¹æ¬¡è¦æ‹…å¿§</h2>
                <p>è®°å½•é‚£äº›æš‚æ—¶ä¸é‡è¦ä½†æœªæ¥å¯èƒ½éœ€è¦å¤„ç†çš„é›¶æ•£æƒ³æ³•ï¼Œè®©æ‚¨èƒ½æ›´ä¸“æ³¨äºå½“å‰ä¸»è¦ä»»åŠ¡ã€‚</p>
                
                <div class="form-group">
                    <label for="otherConcerns">å…¶ä»–æ‹…å¿§æˆ–æƒ³æ³•</label>
                    <textarea id="otherConcerns" placeholder="å†™ä¸‹é‚£äº›ä¸å±äºå‰é¢å¡ç‚¹ï¼Œä½†ä»åœ¨æ‚¨è„‘æµ·ä¸­è¦ç»•çš„æƒ³æ³•..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="followupDate">è®¡åˆ’å›é¡¾æ—¶é—´</label>
                    <input type="date" id="followupDate">
                </div>
                
                <div class="btn-container">
                    <button class="btn" onclick="goToDashboard()">è¿”å›é¦–é¡µ</button>
                    <button class="btn btn-prev" onclick="navigateStep(4)">ä¸Šä¸€æ­¥</button>
                    <button class="btn btn-next" onclick="navigateStep(6)">ä¸‹ä¸€æ­¥ï¼šæ€»ç»“è®¡åˆ’</button>
                </div>
            </div>
            
            <!-- æ­¥éª¤6ï¼šæ€»ç»“è®¡åˆ’ -->
            <div class="step-content" id="step6">
                <h2>æ€»ç»“ä¸è¡ŒåŠ¨è®¡åˆ’</h2>
                
                <div class="form-group">
                    <label for="keyInsight">æ ¸å¿ƒæ´å¯Ÿ</label>
                    <textarea id="keyInsight" placeholder="é€šè¿‡è¿™æ¬¡æƒ…ç»ªåˆ†è§£ï¼Œæ‚¨æœ€é‡è¦çš„å‘ç°æˆ–å†³å®šæ˜¯ä»€ä¹ˆï¼Ÿ"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="nextAction">ä¸‹ä¸€æ­¥è¡ŒåŠ¨</label>
                    <input type="text" id="nextAction" placeholder="æ¥ä¸‹æ¥æœ€åº”è¯¥ç«‹å³å¼€å§‹çš„ä¸€ä¸ªå¾®å°ã€å…·ä½“çš„è¡ŒåŠ¨æ˜¯ä»€ä¹ˆï¼Ÿ">
                </div>
                
                <div class="btn-container">
                    <button class="btn" onclick="goToDashboard()">è¿”å›é¦–é¡µ</button>
                    <button class="btn btn-prev" onclick="navigateStep(5)">ä¸Šä¸€æ­¥</button>
                    <button class="btn btn-next" onclick="completeProcess()">å®Œæˆæƒ…ç»ªåˆ†è§£</button>
                </div>
            </div>
        </div>
        
        <!-- ç¼–è¾‘å¡ç‚¹æ¨¡æ€æ¡† -->
        <div class="modal" id="editModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>ç¼–è¾‘å¡ç‚¹</h2>
                    <button class="modal-close" onclick="closeEditModal()">&times;</button>
                </div>
                <form class="edit-form" id="editForm">
                    <input type="hidden" id="editPointId">
                    
                    <div class="form-group">
                        <label for="editTitle">å¡ç‚¹æ ‡é¢˜</label>
                        <input type="text" id="editTitle" placeholder="ç®€è¦æè¿°è¿™ä¸ªå¡ç‚¹">
                    </div>
                    
                    <div class="form-group">
                        <label for="editType">å¡ç‚¹ç±»å‹</label>
                        <select id="editType">
                            <option value="decision">å†³ç­–å›°å¢ƒï¼ˆéš¾ä»¥é€‰æ‹©ï¼‰</option>
                            <option value="action">è¡ŒåŠ¨å—é˜»ï¼ˆæ‹–å»¶/æ— åŠ›ï¼‰</option>
                            <option value="resources">èµ„æºå†²çªï¼ˆæ—¶é—´/ç²¾åŠ›ä¸è¶³ï¼‰</option>
                            <option value="meaning">æ„ä¹‰æ¨¡ç³Šï¼ˆç¼ºä¹åŠ¨åŠ›ï¼‰</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="editDescription">è¯¦ç»†æè¿°</label>
                        <textarea id="editDescription" placeholder="è¯·è¯¦ç»†æè¿°è¿™ä¸ªå¡ç‚¹"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>å½±å“è¯„ä¼°</label>
                        <div class="impact-selector">
                            <div class="impact-option" data-impact="high">é«˜å½±å“</div>
                            <div class="impact-option" data-impact="medium">ä¸­ç­‰å½±å“</div>
                            <div class="impact-option" data-impact="low">ä½å½±å“</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="editMethod">çªç ´æ–¹æ³•</label>
                        <textarea id="editMethod" placeholder="é’ˆå¯¹è¿™ä¸ªå¡ç‚¹çš„çªç ´æ–¹æ³•"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>è¿›å±•çŠ¶æ€</label>
                        <div class="status-selector">
                            <div class="status-option" data-status="unsolved">æœªè§£å†³</div>
                            <div class="status-option" data-status="solving">è§£å†³ä¸­</div>
                            <div class="status-option" data-status="solved">å·²è§£å†³</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="editScheduledDay">è®¡åˆ’å¤„ç†æ—¥æœŸ</label>
                        <select id="editScheduledDay">
                            <option value="">-- é€‰æ‹©æ—¥æœŸ --</option>
                            <option value="å‘¨ä¸€">å‘¨ä¸€</option>
                            <option value="å‘¨äºŒ">å‘¨äºŒ</option>
                            <option value="å‘¨ä¸‰">å‘¨ä¸‰</option>
                            <option value="å‘¨å››">å‘¨å››</option>
                            <option value="å‘¨äº”">å‘¨äº”</option>
                            <option value="å‘¨å…­">å‘¨å…­</option>
                            <option value="å‘¨æ—¥">å‘¨æ—¥</option>
                        </select>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-delete" onclick="deleteStuckPoint()">åˆ é™¤å¡ç‚¹</button>
                        <div>
                            <button type="button" class="btn btn-prev" onclick="closeEditModal()">å–æ¶ˆ</button>
                            <button type="submit" class="btn btn-next">ä¿å­˜æ›´æ”¹</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- å†å²å¡ç‚¹æ¨¡æ€æ¡† -->
        <div class="modal" id="historyModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>å†å²å¡ç‚¹</h2>
                    <button class="modal-close" onclick="closeHistory()">&times;</button>
                </div>
                <div class="history-list" id="historyList">
                    <!-- å†å²å¡ç‚¹åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // åº”ç”¨çŠ¶æ€ç®¡ç†
        const state = {
            currentStep: 1,
            stuckPoints: [],
            concerns: [],
            
            // ä»localStorageåŠ è½½æ•°æ®
            loadData: function() {
                try {
                    const savedData = localStorage.getItem('emotionDecomposerData');
                    if (savedData) {
                        const parsedData = JSON.parse(savedData);
                        this.stuckPoints = parsedData.stuckPoints || [];
                        this.concerns = parsedData.concerns || [];
                        
                        // ç¡®ä¿æ—¥æœŸå¯¹è±¡æ­£ç¡®è½¬æ¢
                        this.stuckPoints.forEach(point => {
                            if (point.createdAt && typeof point.createdAt === 'string') {
                                point.createdAt = new Date(point.createdAt);
                            }
                        });
                    } else {
                        this.initSampleData();
                    }
                } catch (e) {
                    console.error('åŠ è½½æ•°æ®å¤±è´¥:', e);
                    this.initSampleData();
                }
            },
            
            // ä¿å­˜æ•°æ®åˆ°localStorage
            saveData: function() {
                try {
                    const dataToSave = {
                        stuckPoints: this.stuckPoints,
                        concerns: this.concerns
                    };
                    localStorage.setItem('emotionDecomposerData', JSON.stringify(dataToSave));
                } catch (e) {
                    console.error('ä¿å­˜æ•°æ®å¤±è´¥:', e);
                }
            },
            
            // åˆå§‹åŒ–ç¤ºä¾‹æ•°æ®
            initSampleData: function() {
                if (this.stuckPoints.length === 0) {
                    this.stuckPoints = [
                        {
                            id: 1,
                            title: "æ˜¯å¦æ¢å·¥ä½œ",
                            type: "å†³ç­–å›°å¢ƒ",
                            description: "åœ¨ç°æœ‰å²—ä½ç¨³å®šä½†ç¼ºä¹æˆé•¿ç©ºé—´ï¼Œä¸æ–°æœºä¼šæœ‰æ½œåŠ›ä½†å­˜åœ¨ä¸ç¡®å®šæ€§ä¹‹é—´éš¾ä»¥æŠ‰æ‹©ã€‚",
                            impact: "high",
                            method: "åˆ—å‡ºå½“å‰å·¥ä½œå’Œæ–°æœºä¼šçš„ä¼˜ç¼ºç‚¹å¯¹æ¯”è¡¨",
                            status: "unsolved",
                            scheduledDay: "å‘¨ä¸‰",
                            createdAt: new Date('2023-10-15')
                        },
                        {
                            id: 2,
                            title: "å¥èº«è®¡åˆ’åšæŒå›°éš¾",
                            type: "è¡ŒåŠ¨å—é˜»",
                            description: "åˆ¶å®šäº†æ¯å‘¨ä¸‰æ¬¡çš„å¥èº«è®¡åˆ’ï¼Œä½†æ€»æ˜¯å› ä¸ºå„ç§å€Ÿå£è€Œä¸­æ–­ã€‚",
                            impact: "medium",
                            method: "ä»æ¯å‘¨ä¸€æ¬¡å¼€å§‹ï¼Œé€æ­¥å¢åŠ é¢‘ç‡",
                            status: "solving",
                            scheduledDay: "å‘¨äºŒ",
                            createdAt: new Date('2023-10-20')
                        },
                        {
                            id: 3,
                            title: "å·¥ä½œä¸å­¦ä¹ æ—¶é—´å†²çª",
                            type: "èµ„æºå†²çª",
                            description: "æƒ³è¦å­¦ä¹ æ–°æŠ€èƒ½ä½†å·¥ä½œå ç”¨å¤§é‡æ—¶é—´ï¼Œéš¾ä»¥å¹³è¡¡ã€‚",
                            impact: "high",
                            method: "æ¯å¤©æ—©èµ·1å°æ—¶ä¸“é—¨ç”¨äºå­¦ä¹ ",
                            status: "solved",
                            scheduledDay: "å‘¨ä¸€",
                            createdAt: new Date('2023-10-10')
                        }
                    ];
                    this.saveData();
                }
            },
            
            // è·å–æœªè§£å†³çš„å¡ç‚¹
            getUnsolvedPoints: function() {
                return this.stuckPoints.filter(point => point.status !== 'solved');
            },
            
            // è·å–æœ¬å‘¨å¾…åŠå¡ç‚¹
            getThisWeekPoints: function() {
                return this.stuckPoints.filter(point => 
                    point.status !== 'solved' && point.scheduledDay
                );
            },
            
            // è·å–ä¸‹ä¸€ä¸ªID
            getNextId: function() {
                return this.stuckPoints.length > 0 ? 
                    Math.max(...this.stuckPoints.map(p => p.id)) + 1 : 1;
            }
        };
        
        // ä¿å­˜æ‚å¿µä¿¡æ¯
        function saveConcern() {
            const concernsTextarea = document.getElementById('otherConcerns');
            const followupDate = document.getElementById('followupDate');
            
            if (concernsTextarea.value.trim() !== '') {
                const newConcern = {
                    id: state.concerns.length > 0 ? Math.max(...state.concerns.map(c => c.id)) + 1 : 1,
                    text: concernsTextarea.value,
                    followupDate: followupDate.value,
                    createdAt: new Date()
                };
                
                state.concerns.push(newConcern);
                state.saveData();
                
                // æ¸…ç©ºè¾“å…¥
                concernsTextarea.value = '';
                followupDate.value = '';
            }
        }
        
        // åˆå§‹åŒ–åº”ç”¨
        document.addEventListener('DOMContentLoaded', function() {
            state.loadData();
            renderDashboard();
            
            // æƒ…ç»ªé€‰æ‹©å˜åŒ–æ—¶æ˜¾ç¤º/éšè—è‡ªå®šä¹‰è¾“å…¥
            document.getElementById('emotionSelect').addEventListener('change', function() {
                const customEmotionDiv = document.getElementById('customEmotion');
                if (this.value === 'other') {
                    customEmotionDiv.style.display = 'block';
                } else {
                    customEmotionDiv.style.display = 'none';
                }
            });
            
            // çŠ¶æ€é€‰æ‹©å™¨
            document.querySelectorAll('.status-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.status-option').forEach(opt => {
                        opt.classList.remove('active');
                    });
                    this.classList.add('active');
                });
            });
            
            // å½±å“é€‰æ‹©å™¨
            document.querySelectorAll('.impact-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.impact-option').forEach(opt => {
                        opt.classList.remove('active');
                    });
                    this.classList.add('active');
                });
            });
            
            // å¡ç‚¹ç±»å‹å˜åŒ–æ—¶æ›´æ–°æ˜¾ç¤º
            document.getElementById('stuckPointType').addEventListener('change', updateStuckPointDisplay);
            document.getElementById('stuckPointDescription').addEventListener('input', updateStuckPointDisplay);
            
            // ç¼–è¾‘è¡¨å•æäº¤
            document.getElementById('editForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveEditedPoint();
            });
            
            // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
            window.addEventListener('click', function(e) {
                if (e.target.classList.contains('modal')) {
                    closeEditModal();
                    closeHistory();
                }
            });
        });
        
        // æ¸²æŸ“é¦–é¡µä»ªè¡¨æ¿
        function renderDashboard() {
            renderWeeklySchedule();
            renderUnsolvedPoints();
        }
        
        // æ¸²æŸ“å‘¨è§†å›¾
        function renderWeeklySchedule() {
            const weeklyScheduleEl = document.getElementById('weeklySchedule');
            weeklyScheduleEl.innerHTML = '';
            
            const days = ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥'];
            const weekPoints = state.getThisWeekPoints();
            
            days.forEach(day => {
                const dayEl = document.createElement('div');
                dayEl.className = 'day';
                
                const dayPoints = weekPoints.filter(point => point.scheduledDay === day);
                
                dayEl.innerHTML = `
                    <div class="day-label">${day}</div>
                    ${dayPoints.map(point => `
                        <div class="time-slot" onclick="editStuckPoint(${point.id})">
                            <strong>${point.title}</strong>
                            <div>${point.type}</div>
                        </div>
                    `).join('')}
                    ${dayPoints.length === 0 ? '<div style="color: #999; font-size: 0.8rem;">æ— å®‰æ’</div>' : ''}
                `;
                
                weeklyScheduleEl.appendChild(dayEl);
            });
        }
        
        // æ¸²æŸ“æœªè§£å†³å¡ç‚¹
        function renderUnsolvedPoints() {
            const unsolvedPointsEl = document.getElementById('unsolvedStuckPoints');
            const unsolvedPoints = state.getUnsolvedPoints();
            
            if (unsolvedPoints.length === 0) {
                unsolvedPointsEl.innerHTML = `
                    <div class="empty-state">
                        <p>æš‚æ— æœªè§£å†³çš„å¡ç‚¹</p>
                        <p>ç‚¹å‡»"å¼€å§‹æ–°çš„æƒ…ç»ªåˆ†è§£"æ¥æ·»åŠ ç¬¬ä¸€ä¸ªå¡ç‚¹</p>
                    </div>
                `;
                return;
            }
            
            unsolvedPointsEl.innerHTML = unsolvedPoints.map(point => `
                <div class="stuck-point-item" onclick="editStuckPoint(${point.id})">
                    <div class="stuck-point-header">
                        <div class="stuck-point-title">${point.title}</div>
                        <div class="stuck-point-type">${point.type}</div>
                    </div>
                    <div class="stuck-point-desc">${point.description}</div>
                    <div class="stuck-point-meta">
                        <span>${getImpactText(point.impact)}å½±å“</span>
                        <span class="stuck-point-status ${getStatusClass(point.status)}">
                            ${getStatusText(point.status)}
                        </span>
                    </div>
                </div>
            `).join('');
        }
        
        // æ¸²æŸ“å†å²å¡ç‚¹
        function renderHistoryPoints() {
            const historyListEl = document.getElementById('historyList');
            const allPoints = [...state.stuckPoints].sort((a, b) => 
                new Date(b.createdAt) - new Date(a.createdAt)
            );
            
            historyListEl.innerHTML = allPoints.map(point => `
                <div class="stuck-point-item" onclick="editStuckPoint(${point.id})">
                    <div class="stuck-point-header">
                        <div class="stuck-point-title">${point.title}</div>
                        <div class="stuck-point-type">${point.type}</div>
                    </div>
                    <div class="stuck-point-desc">${point.description}</div>
                    <div class="stuck-point-meta">
                        <span>${getImpactText(point.impact)}å½±å“</span>
                        <span class="stuck-point-status ${getStatusClass(point.status)}">
                            ${getStatusText(point.status)}
                        </span>
                        <span>${formatDate(point.createdAt)}</span>
                    </div>
                    ${point.method ? `<div style="margin-top: 8px; font-size: 0.9rem;"><strong>çªç ´æ–¹æ³•:</strong> ${point.method}</div>` : ''}
                </div>
            `).join('');
        }
        
        // è¾…åŠ©å‡½æ•°
        function getImpactText(impact) {
            const impactMap = {
                'high': 'é«˜',
                'medium': 'ä¸­',
                'low': 'ä½'
            };
            return impactMap[impact] || 'æœªçŸ¥';
        }
        
        function getStatusText(status) {
            const statusMap = {
                'unsolved': 'æœªè§£å†³',
                'solving': 'è§£å†³ä¸­',
                'solved': 'å·²è§£å†³'
            };
            return statusMap[status] || 'æœªçŸ¥';
        }
        
        function getStatusClass(status) {
            const classMap = {
                'unsolved': 'status-unsolved',
                'solving': 'status-solving',
                'solved': 'status-solved'
            };
            return classMap[status] || '';
        }
        
        function formatDate(date) {
            return new Date(date).toLocaleDateString('zh-CN');
        }
        
        // æ˜¾ç¤ºå†å²å¡ç‚¹æ¨¡æ€æ¡†
        function showHistory() {
            renderHistoryPoints();
            document.getElementById('historyModal').style.display = 'flex';
        }
        
        // å…³é—­å†å²å¡ç‚¹æ¨¡æ€æ¡†
        function closeHistory() {
            document.getElementById('historyModal').style.display = 'none';
        }
        
        // ç¼–è¾‘å¡ç‚¹
        function editStuckPoint(id) {
            const point = state.stuckPoints.find(p => p.id === id);
            if (point) {
                // å¡«å……è¡¨å•
                document.getElementById('editPointId').value = point.id;
                document.getElementById('editTitle').value = point.title;
                document.getElementById('editType').value = point.type;
                document.getElementById('editDescription').value = point.description;
                document.getElementById('editMethod').value = point.method || '';
                document.getElementById('editScheduledDay').value = point.scheduledDay || '';
                
                // è®¾ç½®å½±å“ç¨‹åº¦
                document.querySelectorAll('.impact-option').forEach(option => {
                    option.classList.remove('active');
                    if (option.dataset.impact === point.impact) {
                        option.classList.add('active');
                    }
                });
                
                // è®¾ç½®çŠ¶æ€
                document.querySelectorAll('.status-option').forEach(option => {
                    option.classList.remove('active');
                    if (option.dataset.status === point.status) {
                        option.classList.add('active');
                    }
                });
                
                // æ˜¾ç¤ºæ¨¡æ€æ¡†
                document.getElementById('editModal').style.display = 'flex';
            }
        }
        
        // ä¿å­˜ç¼–è¾‘çš„å¡ç‚¹
        function saveEditedPoint() {
            const id = parseInt(document.getElementById('editPointId').value);
            const point = state.stuckPoints.find(p => p.id === id);
            
            if (point) {
                // æ›´æ–°ç‚¹æ•°æ®
                point.title = document.getElementById('editTitle').value;
                point.type = document.getElementById('editType').value;
                point.description = document.getElementById('editDescription').value;
                point.method = document.getElementById('editMethod').value;
                point.scheduledDay = document.getElementById('editScheduledDay').value;
                
                // è·å–å½±å“ç¨‹åº¦
                const activeImpact = document.querySelector('.impact-option.active');
                if (activeImpact) {
                    point.impact = activeImpact.dataset.impact;
                }
                
                // è·å–çŠ¶æ€
                const activeStatus = document.querySelector('.status-option.active');
                if (activeStatus) {
                    point.status = activeStatus.dataset.status;
                }
                
                // ä¿å­˜åˆ°localStorage
                state.saveData();
                
                // å…³é—­æ¨¡æ€æ¡†
                closeEditModal();
                
                // é‡æ–°æ¸²æŸ“ä»ªè¡¨æ¿
                renderDashboard();
                
                alert('å¡ç‚¹å·²æˆåŠŸæ›´æ–°ï¼');
            }
        }
        
        // åˆ é™¤å¡ç‚¹
        function deleteStuckPoint() {
            const id = parseInt(document.getElementById('editPointId').value);
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå¡ç‚¹å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚')) {
                state.stuckPoints = state.stuckPoints.filter(p => p.id !== id);
                state.saveData(); // ä¿å­˜æ›´æ”¹
                closeEditModal();
                renderDashboard();
                alert('å¡ç‚¹å·²åˆ é™¤ï¼');
            }
        }
        
        // å…³é—­ç¼–è¾‘æ¨¡æ€æ¡†
        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none';
        }
        
        // å¼€å§‹æƒ…ç»ªåˆ†è§£
        function startEmotionDecomposition() {
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('decompositionFlow').style.display = 'block';
            updateProgressBar();
        }
        
        // è¿”å›é¦–é¡µ
        function goToDashboard() {
            document.getElementById('dashboard').style.display = 'block';
            document.getElementById('decompositionFlow').style.display = 'none';
            renderDashboard();
        }
        
        // æ›´æ–°è¿›åº¦æ¡
        function updateProgressBar() {
            const progress = ((state.currentStep - 1) / 5) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
            
            // æ›´æ–°æ­¥éª¤æŒ‡ç¤ºå™¨
            document.querySelectorAll('.step-indicator').forEach((indicator, index) => {
                indicator.classList.remove('step-active', 'step-complete');
                
                if (index + 1 === state.currentStep) {
                    indicator.classList.add('step-active');
                } else if (index + 1 < state.currentStep) {
                    indicator.classList.add('step-complete');
                }
            });
        }
        
        // å¯¼èˆªåˆ°æŒ‡å®šæ­¥éª¤
        function navigateStep(step) {
            // åœ¨ç¦»å¼€æ­¥éª¤2æ—¶ä¿å­˜å¡ç‚¹ä¿¡æ¯
            if (state.currentStep === 2) {
                saveStuckPoint();
            }
            
            // åœ¨ç¦»å¼€æ­¥éª¤5æ—¶ä¿å­˜æ‚å¿µä¿¡æ¯
            if (state.currentStep === 5) {
                saveConcern();
            }
            
            // éšè—å½“å‰æ­¥éª¤
            document.getElementById(`step${state.currentStep}`).classList.remove('step-active');
            
            // æ˜¾ç¤ºç›®æ ‡æ­¥éª¤
            document.getElementById(`step${step}`).classList.add('step-active');
            
            // æ›´æ–°å½“å‰æ­¥éª¤
            state.currentStep = step;
            
            // æ›´æ–°è¿›åº¦æ¡
            updateProgressBar();
            
            // å¦‚æœæ˜¯æ­¥éª¤3ï¼Œæ›´æ–°å¡ç‚¹æ˜¾ç¤º
            if (step === 3) {
                updateStuckPointDisplay();
            }
            
            // å¦‚æœæ˜¯æ­¥éª¤4ï¼Œæ¸²æŸ“æ—¶é—´åè°ƒè§†å›¾
            if (step === 4) {
                renderTimeCoordinationView();
            }
            
            // æ»šåŠ¨åˆ°é¡¶éƒ¨
            window.scrollTo(0, 0);
        }
        
        // ä¿å­˜å¡ç‚¹ä¿¡æ¯
        function saveStuckPoint() {
            const typeSelect = document.getElementById('stuckPointType');
            const titleInput = document.getElementById('stuckPointTitle');
            const descriptionTextarea = document.getElementById('stuckPointDescription');
            
            if (typeSelect.value && titleInput.value && descriptionTextarea.value) {
                // è·å–å½±å“ç¨‹åº¦
                let impact = 'medium';
                const activeImpact = document.querySelector('.impact-option.active');
                if (activeImpact) {
                    impact = activeImpact.dataset.impact;
                }
                
                // åˆ›å»ºæ–°å¡ç‚¹
                const newPoint = {
                    id: state.getNextId(),
                    type: typeSelect.options[typeSelect.selectedIndex].text,
                    title: titleInput.value,
                    description: descriptionTextarea.value,
                    impact: impact,
                    method: '',
                    status: 'unsolved',
                    scheduledDay: '',
                    createdAt: new Date()
                };
                
                state.stuckPoints.push(newPoint);
                state.saveData(); // ä¿å­˜åˆ°localStorage
                
                // æ¸…ç©ºè¡¨å•
                typeSelect.value = '';
                titleInput.value = '';
                descriptionTextarea.value = '';
            }
        }
        
        // æ›´æ–°å¡ç‚¹æ˜¾ç¤º
        function updateStuckPointDisplay() {
            const typeSelect = document.getElementById('stuckPointType');
            const titleInput = document.getElementById('stuckPointTitle');
            const descriptionTextarea = document.getElementById('stuckPointDescription');
            const displayDiv = document.getElementById('currentStuckPointDisplay');
            
            if (typeSelect.value && titleInput.value && descriptionTextarea.value) {
                displayDiv.innerHTML = `
                    <h3>å½“å‰å¡ç‚¹ï¼š${titleInput.value}</h3>
                    <p><strong>ç±»å‹ï¼š</strong>${typeSelect.options[typeSelect.selectedIndex].text}</p>
                    <p>${descriptionTextarea.value}</p>
                `;
            } else {
                displayDiv.innerHTML = `
                    <h3>å½“å‰å¡ç‚¹ï¼šå°šæœªå®šä¹‰</h3>
                    <p>è¯·åœ¨ç¬¬äºŒæ­¥ä¸­å¡«å†™å¡ç‚¹ä¿¡æ¯</p>
                `;
            }
        }
        
        // æ¸²æŸ“æ—¶é—´åè°ƒè§†å›¾
        function renderTimeCoordinationView() {
            const timeCoordinationView = document.getElementById('timeCoordinationView');
            timeCoordinationView.innerHTML = '';
            
            const days = ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥'];
            const weekPoints = state.getThisWeekPoints();
            
            days.forEach(day => {
                const dayEl = document.createElement('div');
                dayEl.className = 'day';
                
                const dayPoints = weekPoints.filter(point => point.scheduledDay === day);
                
                dayEl.innerHTML = `
                    <div class="day-label">${day}</div>
                    ${dayPoints.map(point => `
                        <div class="time-slot">
                            <strong>${point.title}</strong>
                            <div>${point.type}</div>
                        </div>
                    `).join('')}
                `;
                
                timeCoordinationView.appendChild(dayEl);
            });
        }
        
        // å®Œæˆæ•´ä¸ªè¿‡ç¨‹
        function completeProcess() {
            const methodTextarea = document.getElementById('breakthroughMethod');
            const scheduledDaySelect = document.getElementById('scheduledDay');
            const keyInsight = document.getElementById('keyInsight').value;
            const nextAction = document.getElementById('nextAction').value;
            
            if (keyInsight && nextAction) {
                // è·å–å½“å‰å¡ç‚¹ï¼ˆæœ€åä¸€ä¸ªåˆ›å»ºçš„ï¼‰
                const currentPoint = state.stuckPoints[state.stuckPoints.length - 1];
                if (currentPoint) {
                    // æ›´æ–°å¡ç‚¹ä¿¡æ¯
                    currentPoint.method = methodTextarea.value;
                    currentPoint.scheduledDay = scheduledDaySelect.value;
                    
                    // è·å–çŠ¶æ€
                    const activeStatus = document.querySelector('.status-option.active');
                    if (activeStatus) {
                        currentPoint.status = activeStatus.dataset.status === 'wrapping' ? 'solved' : 
                                             activeStatus.dataset.status === 'acting' ? 'solving' : 'unsolved';
                    }
                    
                    // ä¿å­˜åˆ°localStorage
                    state.saveData();
                }
                
                alert('æ­å–œï¼æ‚¨å·²ç»å®Œæˆäº†æƒ…ç»ªåˆ†è§£è¿‡ç¨‹ã€‚æ–°çš„å¡ç‚¹å·²æ·»åŠ åˆ°æ‚¨çš„åˆ—è¡¨ä¸­ã€‚');
                
                // è¿”å›é¦–é¡µ
                goToDashboard();
            } else {
                alert('è¯·å¡«å†™æ ¸å¿ƒæ´å¯Ÿå’Œä¸‹ä¸€æ­¥è¡ŒåŠ¨åå†å®Œæˆã€‚');
            }
        }
    </script>
</body>
</html>
